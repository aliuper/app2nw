package com.alibaba.domain.service

import com.alibaba.domain.model.*

/**
 * Panel Güvenlik Testi (Exploit Test) servisi
 * Kendi panelinizin güvenliğini test etmek için kullanılır
 */
interface ExploitTester {
    
    /**
     * Panel güvenlik testini başlatır
     * @param config Test yapılandırması
     * @param onProgress İlerleme callback'i
     * @param onVulnerabilityFound Açık bulunduğunda callback
     * @return Test sonuçları listesi
     */
    suspend fun runExploitTest(
        config: ExploitTestConfig,
        onProgress: (ExploitTestProgress) -> Unit,
        onVulnerabilityFound: (ExploitTestResult) -> Unit
    ): List<ExploitTestResult>
    
    /**
     * Tek bir kimlik bilgisini test eder
     */
    suspend fun testCredential(
        panelUrl: String,
        port: Int,
        username: String,
        password: String
    ): FoundCredential?
    
    /**
     * Panel'in erişilebilir olup olmadığını kontrol eder
     */
    suspend fun checkPanelReachable(panelUrl: String, port: Int): Boolean
}
