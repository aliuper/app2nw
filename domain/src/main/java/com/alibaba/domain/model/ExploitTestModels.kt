package com.alibaba.domain.model

/**
 * Panel Güvenlik Testi (Exploit Test) modelleri
 * Kendi panelinizin güvenliğini test etmek için kullanılır
 */

data class ExploitTestConfig(
    val panelUrl: String,
    val panelPort: Int = 8080,
    // Gelişmiş Exploit Testleri
    val testSqlInjection: Boolean = true,
    val testAuthBypass: Boolean = true,
    val testApiExploit: Boolean = true,
    val testUserIdEnumeration: Boolean = true,
    val testPanelApiExploit: Boolean = true,
    val testConfigLeak: Boolean = true,
    // Eski testler (opsiyonel)
    val testDefaultCredentials: Boolean = false,
    val testPathTraversal: Boolean = true,
    val customWordlist: List<String> = emptyList(),
    // User ID tarama aralığı
    val userIdStart: Int = 1,
    val userIdEnd: Int = 1000
)

data class ExploitTestResult(
    val vulnerability: VulnerabilityType,
    val severity: Severity,
    val description: String,
    val exploitMethod: String,
    val foundCredentials: FoundCredential? = null,
    val recommendation: String,
    val timestamp: Long = System.currentTimeMillis()
)

data class FoundCredential(
    val username: String,
    val password: String,
    val panelUrl: String,
    val userInfo: UserInfo? = null
)

enum class VulnerabilityType(val displayName: String) {
    SQL_INJECTION("SQL Injection"),
    AUTH_BYPASS("Kimlik Doğrulama Bypass"),
    API_USER_DUMP("API Kullanıcı Listesi Sızıntısı"),
    USER_ID_ENUMERATION("User ID Enumeration"),
    PANEL_API_EXPLOIT("Panel API Exploit"),
    CONFIG_LEAK("Yapılandırma Dosyası Sızıntısı"),
    DATABASE_EXPOSURE("Veritabanı Erişimi"),
    DEFAULT_CREDENTIALS("Varsayılan Kimlik Bilgileri"),
    WEAK_PASSWORD("Zayıf Şifre"),
    PATH_TRAVERSAL("Dizin Gezinme Açığı"),
    API_EXPOSURE("API Endpoint Açığı"),
    NO_RATE_LIMIT("Brute-Force Koruması Yok"),
    INFORMATION_DISCLOSURE("Bilgi Sızıntısı"),
    INSECURE_CONFIGURATION("Güvensiz Yapılandırma")
}

enum class Severity(val displayName: String, val color: Long) {
    CRITICAL("Kritik", 0xFFFF0000),
    HIGH("Yüksek", 0xFFFF6600),
    MEDIUM("Orta", 0xFFFFCC00),
    LOW("Düşük", 0xFF00FF00),
    INFO("Bilgi", 0xFF00FFFF)
}

data class ExploitTestProgress(
    val currentTest: String,
    val currentPhase: TestPhase,
    val progress: Int,
    val total: Int,
    val foundVulnerabilities: Int,
    val foundCredentials: Int
)

enum class TestPhase(val displayName: String) {
    INITIALIZING("Başlatılıyor"),
    TESTING_SQL_INJECTION("SQL Injection Test Ediliyor"),
    TESTING_AUTH_BYPASS("Auth Bypass Test Ediliyor"),
    TESTING_API_EXPLOIT("API Exploit Test Ediliyor"),
    TESTING_USER_ID_ENUM("User ID Enumeration Yapılıyor"),
    TESTING_PANEL_API("Panel API Exploit Test Ediliyor"),
    TESTING_CONFIG_LEAK("Config Dosyaları Taranıyor"),
    TESTING_PATH_TRAVERSAL("Dizin Gezinme Test Ediliyor"),
    TESTING_DEFAULT_CREDS("Varsayılan Kimlik Bilgileri Test Ediliyor"),
    COMPLETED("Tamamlandı")
}

// Varsayılan kimlik bilgileri listesi
object DefaultCredentials {
    val credentials = listOf(
        // Standart varsayılanlar
        "admin" to "admin",
        "admin" to "123456",
        "admin" to "password",
        "admin" to "admin123",
        "admin" to "12345678",
        "admin" to "1234",
        "admin" to "",
        "admin" to "admin1234",
        "admin" to "pass123",
        "admin" to "changeme",
        "admin" to "master",
        // Test/Demo
        "test" to "test",
        "test" to "123456",
        "test" to "test123",
        "demo" to "demo",
        "demo" to "123456",
        "demo" to "demo123",
        "trial" to "trial",
        "trial" to "123456",
        "free" to "free",
        "free" to "123456",
        // User/Guest
        "user" to "user",
        "user" to "123456",
        "guest" to "guest",
        "guest" to "123456",
        // Root/System
        "root" to "root",
        "root" to "123456",
        "root" to "toor",
        "administrator" to "administrator",
        "administrator" to "123456",
        // IPTV spesifik
        "iptv" to "iptv",
        "iptv" to "123456",
        "iptv" to "iptv123",
        "panel" to "panel",
        "panel" to "123456",
        "panel" to "panel123",
        "reseller" to "reseller",
        "reseller" to "123456",
        "stream" to "stream",
        "live" to "live",
        "tv" to "tv123",
        "xtream" to "xtream",
        "xtream" to "123456",
        "xc" to "xc",
        "xc" to "123456",
        // Yaygın kullanılan
        "1" to "1",
        "123" to "123",
        "1234" to "1234",
        "12345" to "12345",
        "premium" to "premium",
        "vip" to "vip",
        "gold" to "gold",
        "service" to "service",
        "support" to "support"
    )
}

// Yaygın kullanıcı adları
object CommonUsernames {
    val usernames = listOf(
        "admin", "test", "demo", "user", "guest", "root",
        "administrator", "manager", "operator", "support",
        "service", "backup", "ftp", "mail", "www",
        "trial", "free", "premium", "vip", "gold",
        "silver", "bronze", "basic", "pro", "plus",
        "iptv", "tv", "stream", "live", "watch",
        "panel", "reseller", "dealer", "agent", "client"
    )
}

// Yaygın zayıf şifreler
object CommonPasswords {
    val passwords = listOf(
        "123456", "password", "12345678", "qwerty", "123456789",
        "12345", "1234", "111111", "1234567", "dragon",
        "123123", "baseball", "iloveyou", "trustno1", "sunshine",
        "master", "welcome", "shadow", "ashley", "football",
        "jesus", "michael", "ninja", "mustang", "password1",
        "admin", "admin123", "root", "toor", "pass",
        "test", "guest", "master", "changeme", "123qwe",
        "iptv", "iptv123", "stream", "live", "tv123",
        "panel", "panel123", "reseller", "dealer", "agent"
    )
}
